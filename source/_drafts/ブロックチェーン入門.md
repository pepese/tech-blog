---
title: ブロックチェーン入門
tags:
- blockchain
id: blockchain-basics
---

# ブロックチェーンの特徴

- 分散型台帳
    - 同じ台帳データが複数ノードに配備されているシステム
    - 複数組織間でのコンセンサス、台帳のトレーサビリティにコストがかかっていた領域にメリット
    - 処理完了までの遅延などにデメリット
- ビザンチン将軍問題
    - 分散システムにおいてタイムラグ、未到達、改竄、二重送信などによって偽の情報を伝達する可能性がある場合に、全体として正しい合意を形成できるかを問う問題
- トレーサビリティと透明性
- データの改竄が困難？
- 合意形成アルゴリズム/コンセンサスアルゴリズム
    - ビザンチン将軍問題を解決する仕組み
- パブリック、プライベート、コンソーシアム
    - パブリック型：管理者を置かず、誰でもネットワークに参加可能
    - コンソーシアム型：複数のパートナー企業が管理者とされ、ネットワークへの参加には管理者の許可が必要

[まとめ記事](https://qiita.com/akitoh/items/bebf1bf3d71d3e4b96b0)  
[まとめ資料](http://www.digitalmoney.or.jp/wp-content/uploads/2016/04/201604_BlockChain2.0_v06.pdf)

# 合意形成アルゴリズム/コンセンサスアルゴリズム

以下のようなアルゴリズムがある。

- PoW （ Proof of Work ）
    - Bitcoin Core 、 Ethereum などで使用される
- PoS （ Proof of Stake ）
    - Ethereum 、 mijin などで使用される
- Paxos
    - Google Chubby で使用される
- Raft
    - RAMCloud で使用される
- PBFT （ Practical Byzantine Fault Tolerance ）
    - Hyperledger Fabric で使用される
- Sieve
    - Hyperledger Fabric で使用される

## PoW （ Proof of Work ）

取引記録を P2P ネットワークで受信した参加者たちは受け取った取引記録の承認作業を行う。  
確率的に解答が困難な問題を一番早く解いた（ **Proof of Work** ）人にブロックの生成を許可し、その報酬としてインセンティブが得られる。  
また、通信の断絶状態などによって不整合が生じ、チェーンが分岐した場合は一番長いチェーンを正とすることでデータの一貫性を保証する。  
以下の問題が存在する。

- 51% 問題
    - 特定の人物・組織が所有するマイナーが過半数を占めた場合、結果を自由に操作できる
- ファイナリティの不確実性
    - チェーンが分岐し、短い方を正としていたノードが長い方へ切り替わった場合、自分の口座残高が急に変化したり、取引自体が無くなったりする
    - ビットコインでは、取引が確定しても 6 ブロック待たないと次の取引が実行できないといった制限で発生確率を下げている
- 性能限界
    - ネットワーク伝搬時間を無くすことは不可能で性能を上げることが難しく、リアルタイム性の高い業務には不向き
- ブロックチェーンの容量
    - 全てのノードが全てのブロック情報を保有する必要がある

# ブロックチェーンの構造

- トランザクション
- ブロック
- ブロックチェーン

# OSS

https://qiita.com/kyrieleison/items/ec5223bbe6140822df4a

- Hyperledger Fabric
- Ethereum （イーサリアム）
- Chain

## Hyperledger Fabric

https://www.slideshare.net/Hyperledger_Tokyo/hyperledger-fabric-10

Hyperledger Fabric（ハイパーレッジャー ファブリック）は、 Hyperledger といいう ブロックチェーン技術推進コミュニティ により共同検証された OSS で単に Fabric と呼ばれる。  
The Linux Foundation のプロジェクトの 1 つで Hyperledger Project 。  
Fabric の特徴は以下の通り。

- Industry-focused Design
    - ブロックチェーンは元々不特定多数を対象としたビットコインに利用される技術であったが、知っている者同士で契約を行う場面などビジネスにおける多様なユースケースに応える設計となっている
    - 参加者の登録と証明書発行、権限設定を担うメンバーシップ・サービスを実装しており、トランザクションは個々の参加者の証明書を用いて暗号化されています。プライベートな複数のブロックチェーンネットワークを有効にすることもできます。
- Modular Architecture
    - **メンバーシップサービス** 、 **ブロックチェーンサービス** 、 **チェーンコードサービス** という3つのカテゴリのコアコンポーネント
    - 個別のプロセス・名前空間・仮想マシンを持った物理的な個々の部品になっており、それぞれプラグアンドプレイが可能
    1. メンバーシップサービス
        - 参加者のアイデンティティと権限を管理
        - 参加者に対して登録証明書(Enrollment Certificates, ECert)や取引証明書(Transaction Certificates, TCert)を発行する認証局(CA)の役割を担う
    2. ブロックチェーンサービス
        - HTTP/2 上に構築された P2P プロトコルを通じて、ブロックチェーンとトランザクションを管理
        - 異なるコンセンサス・分散合意形成アルゴリズム(PBFT, Raft, PoW, PoS)にプラグイン可能で、デプロイ毎に設定
    3. チェーンコードサービス
        - ブロックチェーンにトランザクションの一部として保存されるアプリケーションレベルのコード
        - 各ノードでトランザクションを実行する方法(= チェーンコードの実行環境)を提供する
        - 実行環境は OS と言語、Runtime と SDK をセットにした Docker イメージになっており、Go, Java, Node.js をサポート

[公式サイト](https://www.hyperledger.org/)  
[公式 Github リポジトリ](https://github.com/hyperledger/fabric)  
[公式ドキュメント](http://hyperledger-fabric.readthedocs.io/)

# 環境構築

Fabric での環境構築を実施する。

